#!/bin/bash

#Usage: ./hxDelUser <user>
#Ex: ./hxDelUser testUser

uniqueId=$RANDOM
mkdir -p /tmp/$uniqueId/

xen-list-images > /tmp/$uniqueId/all

for i in $( cat /tmp/$uniqueId/all ); do
	if [[ $(echo "$i" | tail -n1 | cut -f2- -d\ | cut -f1 -d\. | cut -f1 -d\-) == "$1" ]]
	then
		echo "$i" | cut -f2- -d\ ) >> /tmp/$uniqueId/hostnames
	fi
done

for j in $( cat /tmp/$uniqueId/hostnames)
	hxDelVM "$j"
done

userdel -r "$1"